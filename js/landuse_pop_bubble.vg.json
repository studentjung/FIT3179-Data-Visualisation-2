{
  "$schema": "https://vega.github.io/schema/vega-lite/v6.json",
  "data": {
    "url": "data/suburb_landuse.topojson",
    "format": {
      "type": "topojson",
      "feature": "sa2_landuse_summary"
    }
  },
  "background": "#303030",
  "config": {
    "axis": {
      "labelColor": "white",
      "titleColor": "white",
      "labelFont": "Open Sans",
      "titleFont": "Open Sans",
      "titleFontSize": 14,
      "labelFontSize": 13
    },
    "title": {
      "color": "white",
      "font": "Open Sans",
      "fontSize": 18
    }
  },
  "title": "Overall increase in Population (2024) vs Land Use",
  "transform": [
    {
      "fold": [
        "properties.transport",
        "properties.credited_open_space",
        "properties.uncredited_open_space",
        "properties.developable_area_residential",
        "properties.education_community_government",
        "properties.developable_area_employment",
        "properties.regional_open_space",
        "properties.other_non_developable_land"
      ],
      "as": ["land_use_type", "area"]
    },
    {
      "lookup": "properties.sa2_name21",
      "from": {
        "data": { "url": "data/pop_vic_2023-24.csv" },
        "key": "suburb_name",
        "fields": ["2023", "2024", "2023-24", "pop_dense_2024"]
      }
    },
    {
      "filter": "datum.area != null && datum.area > 0.05"
    },
    {
      "filter": "datum['2023-24'] != null && datum['2024'] > 0 && datum['2023-24'] > 0"
    },
    {
      "filter": "datum['pop_dense_2024'] != null && datum['pop_dense_2024'] > 0"
    }
  ],
  "autosize": {
    "type": "fit"
  },
  "width": "container",
  "height": 500,
  "mark": { "type": "circle", "opacity": 0.7, "stroke": "black" },
  "encoding": {
    "y": {
      "aggregate": "sum",
      "field": "area",
      "type": "quantitative",
      "title": "Total Land Use (km²)",
      "scale": {
        "type": "log"
      },
      "axis": {
        "values": [0.1, 1, 10, 100, 1000]
      }
    },
    "x": {
      "field": "2023-24",
      "title": "Population Difference",
      "type": "quantitative",
      "scale": {
        "type": "log"
      },
      "axis": {
        "values": [0.1, 1, 10, 100, 1000]
      }
    },
    "size": {
      "field": "2024",
      "type": "quantitative",
      "scale": {
        "type": "log",
        "range": [1, 1500]
      },
      "legend": null
    },
    "color": {
      "field": "pop_dense_2024",
      "type": "quantitative",
      "scale": {
        "type": "log",
        "scheme": "browns"
      },
      "legend": null
    },
    "tooltip": [
      {
        "field": "properties.sa2_name21",
        "type": "nominal",
        "title": "Suburb"
      },
      {
        "aggregate": "sum",
        "field": "area",
        "type": "quantitative",
        "title": "Total Land Use (km²)"
      },
      { "field": "2023", "type": "quantitative", "title": "Population 2023" },
      { "field": "2024", "type": "quantitative", "title": "Population 2024" },
      {
        "field": "2023-24",
        "type": "quantitative",
        "title": "Population Growth"
      },
      {
        "field": "pop_dense_2024",
        "type": "quantitative",
        "title": "Population Density (people/km²)"
      }
    ]
  },
  "resolve": {
    "scale": {
      "x": "independent",
      "y": "independent"
    }
  }
}
